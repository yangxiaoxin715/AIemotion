# �� 移动端录音功能部署指南

## 🔍 问题排查步骤

### 1. **Vercel部署检查**
```bash
# 确保环境变量已设置
OPENAI_API_KEY=your_api_key
OPENAI_MODEL=gpt-4o
```

### 2. **HTTPS要求**
✅ **必须条件**：移动端录音功能需要HTTPS连接
- Vercel自动提供HTTPS，这个应该没问题
- 检查网址是否以 `https://` 开头

### 3. **移动端浏览器兼容性**
📱 **推荐浏览器**：
- ✅ Chrome (Android/iOS) - 最佳支持
- ✅ Safari (iOS) - 部分支持
- ⚠️ Firefox Mobile - 支持有限
- ❌ 微信内置浏览器 - 不支持

### 4. **权限处理**
🎤 **麦克风权限**：
1. 首次访问时浏览器会弹出权限请求
2. 用户必须点击"允许"
3. 如果误点"拒绝"，需要在浏览器设置中重新启用

## 🛠️ 调试工具

### 在浏览器控制台查看日志：
```javascript
// 打开控制台，查看这些信息：
console.log('设备信息')
console.log('移动端录音启动流程')
console.log('麦克风权限获取成功')
```

## 📋 常见问题解决

### ❌ **问题1: 点击录音按钮没反应**
**可能原因：**
- 没有HTTPS连接
- 浏览器不支持
- 权限被拒绝

**解决方案：**
1. 检查网址是否是 `https://` 开头
2. 换用Chrome浏览器
3. 检查权限设置

### ❌ **问题2: 有录音动画但没有转文字**
**可能原因：**
- 网络连接问题
- API调用失败
- 语音识别服务不可用

**解决方案：**
1. 检查网络连接
2. 查看控制台错误信息
3. 等待网络稳定后重试

### ❌ **问题3: iOS Safari特殊问题**
**已知限制：**
- iOS Safari对语音识别支持有限
- 建议用户使用Chrome浏览器

**解决方案：**
1. 引导用户下载Chrome
2. 或使用文字输入功能

## 🔧 手动测试步骤

### 桌面端测试：
1. 打开 https://你的域名.vercel.app
2. 点击录音按钮
3. 允许麦克风权限
4. 说话测试转文字功能

### 移动端测试：
1. 手机Chrome打开网站
2. 检查设备信息显示是否正确
3. 点击录音按钮
4. 允许麦克风权限（关键步骤）
5. 说话测试

## 📱 移动端优化功能

### 自动设备检测：
- 显示设备类型（移动/桌面）
- 显示连接状态（安全/非安全）
- 显示录音支持状态

### 移动端专用设置：
- 优化音频参数（16kHz, 单声道）
- 调整语音识别参数
- 增加网络超时时间（60秒）

### 用户引导：
- 移动端使用指南
- 详细错误提示
- 权限设置指导

## 🚀 部署建议

### Vercel环境变量设置：
```
OPENAI_API_KEY=sk-your-api-key
OPENAI_MODEL=gpt-4o
```

### 域名设置：
- 确保使用Vercel提供的HTTPS域名
- 如果使用自定义域名，确保SSL证书正常

## 📞 支持与反馈

如果问题仍然存在，请提供：
1. 设备型号和浏览器版本
2. 网站URL
3. 控制台错误信息
4. 复现步骤

这样我们可以更精准地定位和解决问题。
